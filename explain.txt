this version contaions graphexpanding that checked, and it is correct. 